## Предсказание температуры стали
### Описание проекта
Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Нам предстоит построить модель, которая предскажет температуру стали.
В нашем распоряжении есть данные о режимах нагрева и внесения легирующих добавок, объёмах продуваемого инертного газа, температуре стали на разных этапах для более чем 3000 процессов обработки стали.

### Отчёт
1. Были выполнены все пункты плана. Отдельно остановимся на предобработке и подготовке признаков:

- Была найдена суммарная активная мощность для каждого процесса;
- Было найдено число циклов нагрева для каждого процесса;
- Из таблицы с данными о температуре были извлечены начальная и конечная температуры, конечная температура была не у всех процессов, пришлось избавиться примерно от 23% процессов в этой таблице;
- Были использованы данные об объёмах всех добавок (кроме Bulk 9) и продуваемого газа. Пропуски в данных об объёмах добавок были заполнены нулями;
- Данные соединены попринципу пересечения ключей - в конечной таблице присутствуют лишь те процессы, информация о которых есть в каждой из таблиц;
- Данные о времени и длительности нагрева и внесении добавок, величине реактивной мощности не были использованы. Данные о времени измерения температуры были использованы только для того, чтобы понять, какая температура начальная, какая конечная.

Изначально на этапе подготовки признаков планировалось масштабирование, но оказалось, что оно негативно сказывается на скорости подбора гиперпараметров и метрике. Поэтому я иключила этот пункт. Пункт с анализом и устранением мультиколлинеарности - наоборот - был добавлен в план, был исключен признак Bulk 9, сильно коррелировавший с признаком Wire 8.


2. Основная трудность была в поиске "подводных камней", ухудшающих качество прогноза.

- У части процессов в таблице с данными об измерении температуры отсутствовала конечная температура (целевой признак).
- Наличие мультиколлинеарности. Сильная корреляция между признаками Bulk 9 и Wire 8.

3. Этапы плана и были ключевыми шагами работы. Плюс работа с "подводными камнями", перечисленными в предыдущем пункте.


4. Итоговая модель - CatBoost (политика роста Lossguide, 1000 итераций, глубина деревьев 28, скорость обучения 0.03, коэффициент при члене регуляризации L2 функции потерь 10), random_state 171022. MAE на обучающей выборке - 5.88, MAE на тестовой выборке - 5.83. Модель использовала следующие признаки:

- Суммарная активная мощность для каждого процесса (она же переданная энергия);
- Число циклов нагрева;
- Начальная температура;
- Конечная теммпература (целевой признак);
- Объём каждой из сыпучих добавок (Bulk 1-8 и 10-15);
- Объём проволочных добавок (Wire 1-9);
- Объём пропущенного газа.

Значимые признаки для модели и их коэффициенты значимости:

- Переданная энергия 23.5
- Начальная температура 21.0
- Wire 1 9.5
- Bulk 6 6.6
- Wire 2 6.0
- Bulk 12 5.2
- Газ 1 4.7
- Bulk 15 4.0
- Bulk 14 3.9
- Число циклов 2.4
- Bulk 3 2.1
- Bulk 1 2.0
- Bulk 4 2.0
- Bulk 7 1.8
- Wire 6 1.5
- Wire 3 1.1
- Bulk 11 0.9
- Bulk 5 0.6
- Bulk 10 0.5
- Wire 7 0.3
- Wire 4 0.3
- Bulk 13 0.1
